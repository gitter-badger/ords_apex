var ToggleCore=function(pOptions){return function(){pOptions=jQuery.extend({},{useSessionStorage:!0,defaultExpandedPreference:!1,onClick:function(){},onResize:function(){},onInitialize:function(){userPreference?forceExpand():forceCollapse()},onCollapse:function(){},onExpand:function(){}},pOptions);var key=pOptions.key,defaultExpandedPreference=pOptions.defaultExpandedPreference,onExpand=pOptions.onExpand,onCollapse=pOptions.onCollapse,onResize=pOptions.onResize,onClick=pOptions.onClick,onInitialize=pOptions.onInitialize,content=pOptions.content,contentClassExpanded=pOptions.contentClassExpanded,contentClassCollapsed=pOptions.contentClassCollapsed,controllingElement$=pOptions.controllingElement,controllingElementSelector=pOptions.controllingElementSelector,useSessionStorage=pOptions.useSessionStorage,sessionStorage=apex.storage.getScopedSessionStorage({prefix:key,usePageId:!0,useAppId:!0}),expanded=!1,userPreference=defaultExpandedPreference;if(useSessionStorage){var storedContractedPreference=sessionStorage.getItem("preferenceForExpanded");storedContractedPreference&&(userPreference="true"==storedContractedPreference)}(!controllingElement$||controllingElement$.length<1)&&(controllingElement$=$(controllingElementSelector)),controllingElement$&&controllingElement$.click(function(pEvent){onClick.call(toggleCore),toggle(),controllingElement$.focus(),pEvent.preventDefault()});var setUserPreference=function(pUserPreference){userPreference=pUserPreference,useSessionStorage&&sessionStorage.setItem("preferenceForExpanded",userPreference)},forceExpand=function(){expanded=!1,expand.call(toggleCore)},forceCollapse=function(){expanded=!0,collapse.call(toggleCore)},expand=function(pUserWantsToSetPreference){expanded||(expanded=!0,pUserWantsToSetPreference&&setUserPreference(expanded),content.removeClass(contentClassCollapsed).addClass(contentClassExpanded),onExpand())},collapse=function(pUserWantsToSetPreference){expanded&&(expanded=!1,pUserWantsToSetPreference&&setUserPreference(expanded),content.addClass(contentClassCollapsed).removeClass(contentClassExpanded),onCollapse())},toggle=function(){expanded?collapse.call(toggleCore,!0):expand.call(toggleCore,!0)},toggleCore={key:key,setUserPreference:setUserPreference,doesUserPreferExpanded:function(){return userPreference},isExpanded:function(){return expanded},toggle:function(){toggle.call(toggleCore)},expand:function(){expand.call(toggleCore)},collapse:function(){collapse.call(toggleCore)},forceExpand:forceExpand,forceCollapse:forceCollapse,resize:function(){onResize.call(toggleCore)},initialize:function(){onInitialize.call(toggleCore)}};return toggleCore}()};