!function(util,debug,lang,$,undefined){"use strict";function renderIcon(out,iconType,iconName){out.markup("<span").attr("class",iconType+" "+iconName).markup("></span>")}function menuResize(){var i,$menu,$item,x,y;for(menuLauncher?(x=$(menuLauncher),y=null):(x=originalX,y=originalY),placeMenu({$menu:menuStack[0],subMenu:!1,x:x,y:y,slide:!1}),i=1;i<menuStack.length;i++)$menu=menuStack[i],$item=$menu.parents(SEL_ITEM).eq(0),placeMenu({$menu:$menu,subMenu:!0,x:$item,slide:!1})}function menubarResize(){$(SEL_MENUBAR).each(function(){$(this).menu("resize")})}function startTrackingMenus(){isTracking||(isTracking=!0,$(window).on("blur.menuTracking",function(){menuManager.closeAll(!0)}),$("html").on("mousedown.menuTracking",function(e){var $target=$(e.target);0!==$target.closest(SEL_MENU).length||menuLauncher&&0!==$target.closest(menuLauncher).length||menuManager.closeAll(!0)}).on("mousemove.menuTracking",function(e){var $target,menu;(lastTrackingMouseX!==e.pageX||lastTrackingMouseY!==e.pageY)&&(lastTrackingMouseX=e.pageX,lastTrackingMouseY=e.pageY,$target=$(e.target),menu=$target.parents(SEL_MENU)[0],!menu&&currentMenuBar&&(menu=$target.parent(SEL_MENUBAR)[0]),!menu&&lastMenu&&lastMenu!==menu&&$(lastMenu).focus(),lastMenu=menu)}),apex.tooltipManager&&apex.tooltipManager.disableTooltips())}function stopTrackingMenus(){$(window).off(".menuTracking"),$("html").off(".menuTracking"),isTracking=!1,apex.tooltipManager&&apex.tooltipManager.enableTooltips()}function getMenuScrollParent($menu){return $menu.children().children(SEL_MENU_SCROLL)}function placeMenu(o){var out,menuh,maxMenuHeight,scale,itemHeight,$menu=o.$menu,posInfo={},isVisible="none"!==$menu.css("display");isVisible||$menu.css({display:"block",position:"absolute",top:-99999,left:0}),o.minWidth&&$menu.css("min-width",o.minWidth),"true"!==$menu.attr("data-custom")&&(itemHeight=$menu.find("li").first().outerHeight(),maxMenuHeight=$(window).height(),scale=maxMenuHeight>1e3?.6:maxMenuHeight>500?.75:.9,maxMenuHeight=Math.floor(maxMenuHeight*scale/itemHeight)*itemHeight-itemHeight,menuh=$menu.height(),menuh>maxMenuHeight?(0===getMenuScrollParent($menu).length&&(out=util.htmlBuilder(),out.markup("<div").attr("class",C_MENU_SCROLL_BTN+"  "+C_UP).markup(">"),renderIcon(out,C_DEFAULT_ICON_TYPE,C_ICON_SCROLL_UP),out.markup("</div>"),$menu.children().first().addClass(C_MENU_SCROLLABLE).prepend(out.toString()).append(out.toString().replace(C_ICON_SCROLL_UP,C_ICON_SCROLL_DOWN).replace(C_UP,C_DOWN)).children("ul").first().wrap("<div class='"+C_MENU_SCROLL+"'></div>")),getMenuScrollParent($menu).height(maxMenuHeight)[0].scrollTop=0,$menu.find(SEL_MENU_SCROLL_BTN+"."+C_UP).addClass(C_DISABLED)):getMenuScrollParent($menu).length>0&&($menu.children().first().removeClass(C_MENU_SCROLLABLE).children(SEL_MENU_SCROLL_BTN).remove(),$menu.find("ul").first().unwrap())),"number"==typeof o.x&&"number"==typeof o.y?(originalX=o.x,originalY=o.y,posInfo.of=$.Event("click",{pageX:originalX,pageY:originalY})):(originalX=originalY=null,posInfo.of=o.x),currentIsRtl?o.subMenu?(posInfo.my="right top",posInfo.at="left top"):(posInfo.my="right top",posInfo.at="right bottom"):o.subMenu?(posInfo.my="left top",posInfo.at="right top"):(posInfo.my="left top",posInfo.at="left bottom"),posInfo.collision="flipfit flipfit",$menu.position(posInfo),$menu.css("display",isVisible?"block":"none"),isVisible||(o.slide?$menu.slideDown(200):$menu.show(),o.focus&&$menu.focus())}function itemIsMenuBarItem($item){return $item.parent().parent().hasClass(C_MENUBAR)}function findItemById(menu,id){var theItem=null;return $.each(menu.items,function(i,item){return item.id===id?(theItem=item,!1):"subMenu"===item.type&&(theItem=findItemById(item.menu,id),null!==theItem)?!1:void 0}),theItem}function getChoiceFromId(id){var choice=null,index=id.search(/_c[0-9]+$/);return index>=0&&(choice=1*id.substring(index+2)),choice}function invokeItem(item,choice,menuOptions,typeOverride,delay){function doAction(){"string"==typeof item.action&&apex.actions?(debug.info("Invoke action menu item '"+(item.label||apex.actions.lookup(item.action).label)+"'"),actionTookFocus=apex.actions.invoke(item.action,{},menuLauncher)||!1):(debug.info("Invoke action menu item '"+item.label+"'"),item.action?actionTookFocus=item.action(menuOptions,menuLauncher)||!1:item.href&&(apex.navigation.redirect(item.href),actionTookFocus=!0))}var value,isAction=!1,type=typeOverride||item.type;try{if("toggle"===type)"string"==typeof item.action&&apex.actions&&(item=apex.actions.lookup(item.action),isAction=!0),value=!item.get(),debug.info("Invoke toggle menu item '"+(item.label||(value?item.onLabel:item.offLabel))+"' value now "+value),item.set(value),isAction&&apex.actions.update(item.name),actionTaken=!0;else if("radioGroup"===type)value=item.choices[choice].value,debug.info("Invoke choice menu item '"+item.choices[choice].label+"' value now "+value),item.set(value),actionTaken=!0;else if("action"===type)delay?setTimeout(function(){doAction()},210):doAction(),actionTaken=!0;else if("subMenu"===type)return!1}catch(ex){debug.error("Error in menu action.",ex)}return!0}function descendentIsCurrent(item,clear){var i,curItem;if(item.menu&&item.menu.items)for(i=0;i<item.menu.items.length;i++)if(curItem=item.menu.items[i],curItem.current||descendentIsCurrent(curItem,clear))return clear&&curItem.current&&delete curItem.current,!0;return!1}function getLabelFromMessage(item){item.labelKey&&(item.label=lang.getMessage(item.labelKey)),item.onLabelKey&&(item.onLabel=lang.getMessage(item.onLabelKey)),item.offLabelKey&&(item.offLabel=lang.getMessage(item.offLabelKey))}function setItemFocus(item$){item$.is(SEL_FOCUSABLE)?item$.focus():item$.find(SEL_FOCUSABLE).first().focus()}function getItemsForMenu(menu$){var parentItem,items$;return parentItem=menu$.closest(SEL_MENU_ITEM)[0],items$=menu$.find(SEL_MENU_ITEM).not(function(index,element){var p=$(element).parent().closest(SEL_MENU_ITEM)[0];return p!==parentItem})}function getItemLabel(item$){var label$=item$.children(SEL_MENUITEM_LABEL);return 0===label$.length&&(label$=item$.children(SEL_ITEM_INNER).find(SEL_MENUITEM_LABEL)),label$}var currentMenu=null,currentMenuBar=null,currentIsRtl=!1,menuLauncher=null,actionTookFocus=!1,actionTaken=!1,menuStack=[],menuLayoutDone=[],isTracking=!1,keepTracking=!1,originalX=null,originalY=null,lastMouseX=0,lastMouseY=0,lastTrackingMouseX=0,lastTrackingMouseY=0,subMenuDelayID=null,subMenuCloseDelayID=null,closeDelayMenu=null,lastMenu=null,lastItem=null,C_MENUBAR="a-MenuBar",SEL_MENUBAR=".a-MenuBar",C_MENUBAR_TABS="a-MenuBar--tabs",C_MENU="a-Menu",SEL_MENU=".a-Menu",C_MENU_TOP="a-Menu--top",C_MENU_CONTENT="a-Menu-content",SEL_MENU_CONTENT="."+C_MENU_CONTENT,C_MENU_SCROLL="a-Menu-scroll",SEL_MENU_SCROLL=".a-Menu-scroll",C_MENU_SCROLL_BTN="a-Menu-scrollBtn",SEL_MENU_SCROLL_BTN=".a-Menu-scrollBtn",C_MENU_SCROLLABLE="a-Menu--scrollable",C_UP="a-Menu-scrollBtn--up",C_DOWN="a-Menu-scrollBtn--down",C_ICON_SCROLL_UP="icon-menu-scroll-up",C_ICON_SCROLL_DOWN="icon-menu-scroll-down",C_ITEM="a-Menu-item",SEL_MENU_ITEM="."+C_ITEM,SEL_ITEM=".a-Menu-item, .a-MenuBar-item",SEL_ITEM_INNER=".a-Menu-inner",SEL_ITEM_IN_MENU=".a-Menu-item, .a-MenuBar-item, .a-Menu-content",SEL_ITEM_OR_BTN=SEL_ITEM_IN_MENU+", "+SEL_MENU_SCROLL_BTN,C_ITEM_DEFAULT="a-Menu-item--default",C_BAR_ITEM="a-MenuBar-item",C_BAR_OVERFLOW="a-MenuBar-item--overflow",C_OVERFLOW="a-MenuBar--overflow",C_STATUS_COL="a-Menu-statusCol",C_LABEL="a-Menu-label",C_ACCEL="a-Menu-accel",C_BAR_LABEL="a-MenuBar-label",SEL_LABEL=".a-Menu-label",SEL_MENUITEM_LABEL=".a-Menu-label,.a-MenuBar-label",C_SUBMENU_COL="a-Menu-subMenuCol",SEL_SUBMENU_COL=".a-Menu-subMenuCol",C_SPLIT_MENU="a-Menu--split",C_CURRENT_MENU="a-Menu--current",C_HSEP="a-Menu-hSeparator",C_ITEM_SEP="a-Menu-itemSep",SEL_ITEM_SEP=".a-Menu-itemSep",C_DISABLED="is-disabled",C_FOCUSED="is-focused",C_ACTIVE="is-active",SEL_FOCUSED=".is-focused",SEL_FOCUSABLE="a, button, .a-Menu-label, .a-MenuBar-label",C_EXPANDED="is-expanded",SEL_EXPANDED=".is-expanded",C_DEFAULT_ICON_TYPE="a-Icon",SEL_MENUBUTTON="button.js-menuButton",C_RTL="u-RTL",A_EXPANDED="aria-expanded",A_DISABLED="aria-disabled",A_HASPOPUP="aria-haspopup",A_CHECKED="aria-checked",keys=$.ui.keyCode;$(document).ready(function(){$(window).on("apexwindowresized",function(){menubarResize(),isTracking&&menuResize()})});var menuManager={openMenu:function($menu,$menuBar,x,y,slide,focus){var minWidth=0;this.closeAll(),currentMenu=$menu[0],currentMenuBar=$menuBar?$menuBar[0]:null,currentIsRtl=$(currentMenuBar||currentMenu).hasClass(C_RTL),menuLauncher="object"==typeof x&&x.get?x[0]:null,actionTookFocus=!1,actionTaken=!1,keepTracking=!0,0===menuStack.length&&startTrackingMenus(),menuStack.push($menu),keepTracking=!1,menuLayoutDone=[],$menuBar&&(x.addClass(C_EXPANDED).children(SEL_MENUITEM_LABEL).attr(A_EXPANDED,"true"),minWidth=x.outerWidth()),placeMenu({$menu:$menu,subMenu:!1,x:x,y:y,slide:slide,focus:focus,minWidth:minWidth})},isCurrentMenu:function(menu){return currentMenu&&currentMenu===menu},isCurrentMenuBar:function(menubar){return currentMenuBar&&currentMenuBar===menubar},openSubMenu:function($item,$menu,menuBarItem,slide,focus){this.closeOpenSiblings($item,menuBarItem),menuStack.push($menu),placeMenu({$menu:$menu,subMenu:!0,x:$item,slide:slide,focus:focus}),$item.addClass(C_EXPANDED).children(SEL_ITEM_INNER).find(SEL_MENUITEM_LABEL).attr(A_EXPANDED,"true")},closeOpenSiblings:function($item,menuBarItem){var $openSubMenu=$item.parent().find(SEL_EXPANDED);for(menuBarItem&&(keepTracking=!0);$openSubMenu.length>0;)this.closeLast(!1),$openSubMenu=$item.parent().find(SEL_EXPANDED);keepTracking=!1},closeLast:function(focus){var $menu,$item,$label,$menuLauncher;menuStack.length>0?($menu=menuStack.pop(),$item=$menu.parents(SEL_ITEM).eq(0),$item.length>0&&($label=getItemLabel($item),$item.removeClass(C_EXPANDED).children(SEL_ITEM_INNER),$label.attr(A_EXPANDED,"false"),focus&&$item.find(SEL_FOCUSABLE).eq(0).focus()),$menu.hide(),0===menuStack.length&&(!menuLauncher||actionTookFocus||keepTracking||setTimeout(function(){$menuLauncher=$(menuLauncher),$menuLauncher.is(SEL_ITEM)?$menuLauncher.find(SEL_FOCUSABLE).focus():$menuLauncher.focus()},10),currentMenuBar&&($label=getItemLabel($(currentMenu).find(SEL_EXPANDED)),$(currentMenu).find(SEL_EXPANDED).removeClass(C_EXPANDED),$label.attr(A_EXPANDED,"false")),(currentMenuBar||currentMenu)&&$(currentMenuBar||currentMenu).data("apex-menu")._trigger("afterClose",{},{actionTookFocus:actionTookFocus,actionTaken:actionTaken,launcher:menuLauncher}),currentMenu=null,keepTracking||(currentMenuBar=null,stopTrackingMenus()))):(currentMenu=null,currentMenuBar=null,stopTrackingMenus())},closeAll:function(force){for(;menuStack.length>0;)this.closeLast(!1);force&&(currentMenu=null,currentMenuBar=null,stopTrackingMenus())}};$.widget("apex.menu",{version:"5.0",widgetEventPrefix:"menu",options:{menubar:!1,menubarShowSubMenuIcon:null,menubarOverflow:!1,iconType:C_DEFAULT_ICON_TYPE,behaveLikeTabs:!1,tabBehavior:"EXIT",useLinks:!0,slide:!1,firstItemIsDefault:!1,items:null,idPrefix:null,customContent:!1,asyncFetchMenu:null,beforeOpen:null,afterClose:null},isActive:!1,scrollTimerId:null,forwardKey:keys.RIGHT,backwardKey:keys.LEFT,_create:function(){var i,wheelEvent,o=this.options,$ctrl=this.element;if(o.menubar&&o.customContent)throw"Menubar cannot have custom content";if(o.items||o.customContent===!0||(o.items=this._parseMenuMarkup($ctrl,o.menubar).items),!o.menubar&&(o.customContent||o.asyncFetchMenu)||o.items&&0!==o.items.length||debug.error("Menu has no menu items"),"rtl"===$ctrl.css("direction")&&($ctrl.addClass(C_RTL),o.menubar||$ctrl.attr("dir","rtl"),this.forwardKey=keys.LEFT,this.backwardKey=keys.RIGHT),$ctrl.attr("tabindex",-1).attr("role",o.menubar?"menubar":"menu").addClass(o.menubar?C_MENUBAR:C_MENU),o.menubar){if(o.menubarOverflow&&$ctrl.addClass(C_OVERFLOW),null===o.menubarShowSubMenuIcon)for(o.menubarShowSubMenuIcon=!1,i=0;i<o.items.length;i++)if("subMenu"!==o.items[i].type){o.menubarShowSubMenuIcon=!0;break}this.refresh(),o.behaveLikeTabs&&$ctrl.addClass(C_MENUBAR_TABS),o.firstItemIsDefault&&debug.warn("Invalid options for menu bar ignored")}else $("body").append($ctrl),$ctrl.hide(),(o.menubarOverflow||o.menubarShowSubMenuIcon||o.behaveLikeTabs)&&debug.warn("Invalid options for popup menu ignored");"onwheel"in $ctrl[0]||!this._eventHandlers.wheel||(wheelEvent=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll",this._eventHandlers[wheelEvent]=this._eventHandlers.wheel,delete this._eventHandlers.wheel),this._on(this._eventHandlers)},_eventHandlers:{mousedown:function(e){var item,id,onDropDown,$target;1!==e.which||e.shiftKey||e.ctrlKey||($target=$(e.target).closest(SEL_ITEM_OR_BTN),e.preventDefault(),$target.length>0&&!$target.hasClass(C_MENU_CONTENT)&&!$target.hasClass(C_DISABLED)&&($target.is(SEL_MENU_SCROLL_BTN)?($target.addClass(C_ACTIVE),this._startScrolling($target.closest(SEL_MENU),$target.hasClass(C_UP))):itemIsMenuBarItem($target)&&(id=$target[0].id,item=this._getMenuItemFromId(id),"subMenu"===item.type&&(onDropDown=0!==$(e.target).closest(SEL_SUBMENU_COL).length,(onDropDown||!item.action&&!item.href)&&this.toggle($target)))))},mouseup:function(e){var item,choice,id,isMenuBarItem,type,onDropDown,$target;1!==e.which||e.shiftKey||e.ctrlKey||($target=$(e.target).closest(SEL_ITEM_IN_MENU),e.preventDefault(),$target.length>0&&!$target.hasClass(C_MENU_CONTENT)&&(id=$target[0].id,item=this._getMenuItemFromId(id),type=item.type,isMenuBarItem=itemIsMenuBarItem($target),"subMenu"===type&&isMenuBarItem&&(onDropDown=0!==$(e.target).closest(SEL_SUBMENU_COL).length,onDropDown||!item.action&&!item.href||(type="action",menuManager.closeOpenSiblings($target,isMenuBarItem))),"subMenu"===type&&isMenuBarItem||!$target.is(SEL_ITEM)||$target.hasClass(C_DISABLED)||"display"===type||(choice=getChoiceFromId(id),invokeItem(item,choice,this.options,type)&&menuManager.closeAll())))},click:function(e){var $target,id,item,choice;return"A"===e.target.nodeName&&(1!==e.which||e.shiftKey||e.ctrlKey)?void(this.keyboardActivate=!1):(e.preventDefault(),void(this.keyboardActivate&&(this.keyboardActivate=!1,$target=$(e.target).closest(SEL_ITEM_IN_MENU),$target.length>0&&!$target.hasClass(C_MENU_CONTENT)&&(id=$target[0].id,item=this._getMenuItemFromId(id),$target.is(SEL_ITEM)&&!$target.hasClass(C_DISABLED)&&(choice=getChoiceFromId(id),invokeItem(item,choice,this.options,"subMenu"===item.type?"action":item.type)&&menuManager.closeAll())))))},mousemove:function(e){function checkDelayClose(){var $expanded=$item.parent().find(SEL_EXPANDED);$expanded.length>0&&!subMenuCloseDelayID&&($expanded.removeClass(C_EXPANDED),closeDelayMenu=$expanded.find(SEL_MENU)[0],subMenuCloseDelayID=setTimeout(function(){$expanded.addClass(C_EXPANDED),subMenuCloseDelayID=null,closeDelayMenu=null,menuManager.closeOpenSiblings($item,isMenuBarItem)},250))}var isMenuBarItem,$target,$item,$menu,self=this;if(lastMouseX!==e.pageX||lastMouseY!==e.pageY){if(lastMouseX=e.pageX,lastMouseY=e.pageY,$target=$(e.target),subMenuCloseDelayID&&$target.closest(SEL_MENU)[0]===closeDelayMenu&&($(closeDelayMenu).parent().addClass(C_EXPANDED),closeDelayMenu=null,clearTimeout(subMenuCloseDelayID),subMenuCloseDelayID=null),$item=$target.closest(SEL_ITEM_SEP),$item.length>0&&$item[0]!==lastItem)return subMenuDelayID&&(clearTimeout(subMenuDelayID),subMenuDelayID=null),isMenuBarItem=itemIsMenuBarItem($item),checkDelayClose(),lastItem=$item[0],$menu=$target.closest(SEL_MENU).eq(0),void($menu.length>0&&!$menu.hasClass(C_FOCUSED)&&$menu.focus());if($item=$target.closest(SEL_ITEM),$item.length>0){if(!$item.hasClass(C_FOCUSED)&&"true"!==getItemLabel($item).attr(A_EXPANDED)){if(subMenuDelayID&&(clearTimeout(subMenuDelayID),subMenuDelayID=null),isMenuBarItem=itemIsMenuBarItem($item),isMenuBarItem&&isTracking?(clearTimeout(subMenuCloseDelayID),subMenuCloseDelayID=null,menuManager.closeOpenSiblings($item,isMenuBarItem)):checkDelayClose(),this.options.menubar&&!menuManager.isCurrentMenuBar(this.element[0])&&!this.isActive)return this.element.find(SEL_FOCUSED).removeClass(C_FOCUSED),void $item.addClass(C_FOCUSED);setItemFocus($item),!$item.hasClass(C_DISABLED)&&$item.find(SEL_MENU).length>0&&"true"!==getItemLabel($item).attr(A_EXPANDED)&&(isMenuBarItem?menuManager.isCurrentMenuBar(this.element[0])&&this.open($item):subMenuDelayID=setTimeout(function(){subMenuDelayID=null,menuManager.openSubMenu($item,$item.children(SEL_MENU).first(),isMenuBarItem,self.options.slide,!0)},300))}lastItem=$item[0]}else $target.closest(SEL_MENU).first().focus()}},mouseleave:function(){subMenuDelayID&&(clearTimeout(subMenuDelayID),subMenuDelayID=null),this.options.menubar&&(menuManager.isCurrentMenuBar(this.element[0])||this.isActive||this.element.find(SEL_FOCUSED).removeClass(C_FOCUSED))},wheel:function(e){var sp,$menu=$(e.target).closest(SEL_MENU),deltaY=e.originalEvent.deltaY||e.originalEvent.detail||-1/40*e.originalEvent.wheelDelta;if($menu.length){if(e.preventDefault(),sp=getMenuScrollParent($menu)[0],!sp)return;(e.originalEvent.deltaMode===undefined||1===e.originalEvent.deltaMode)&&(deltaY=30*deltaY),sp.scrollTop+=deltaY,this._checkScrollBounds($menu,sp)}},keydown:function(e){function moveNext(noWrap){var i;if(cur$.hasClass(C_MENU))next$=cur$.find(SEL_MENU_CONTENT).first().find(SEL_ITEM).first();else{if(i=items$.index(cur$),i+=1,i>=items$.length){if(noWrap)return!1;i=0}next$=items$.eq(i)}return setItemFocus(next$),cur$=next$,sp&&self._checkScrollBounds(thisMenu$,sp),!0}function movePrev(noWrap){var i;if(cur$.hasClass(C_MENU))next$=cur$.find(SEL_MENU_CONTENT).first().find(SEL_ITEM).last();else{if(i=items$.index(cur$),i-=1,0>i){if(noWrap)return!1;i=items$.length-1}next$=items$.eq(i)}return setItemFocus(next$),cur$=next$,sp&&self._checkScrollBounds(thisMenu$,sp),!0}function openMenu(){self.toggle(cur$),cur$.hasClass(C_SPLIT_MENU)?cur$.find(SEL_FOCUSABLE).eq(0).focus():(next$=cur$.find(SEL_MENU_CONTENT).first().find(SEL_ITEM).first(),setItemFocus(next$))}var cur$,items$,menu$,next$,$ctrl,isMenuBarItem,sp,thisMenu$,index,tabbable$,id,item,type,choice,tabBehavior,self=this,kc=e.which;if(!e.altKey)if($ctrl=this.element,this.keyboardActivate=!1,$ctrl.hasClass(C_FOCUSED)?(cur$=$ctrl,$ctrl.find(SEL_EXPANDED).first().each(function(){cur$=$(this)})):cur$=$ctrl.find(SEL_FOCUSED),thisMenu$=cur$.closest(SEL_MENU+","+SEL_MENUBAR),sp=getMenuScrollParent(thisMenu$)[0],isMenuBarItem=cur$.is(SEL_MENUBAR)||itemIsMenuBarItem(cur$),items$=isMenuBarItem?$ctrl.find("."+C_BAR_ITEM):getItemsForMenu(thisMenu$),kc===keys.UP||kc===keys.DOWN)isMenuBarItem?cur$.children(SEL_MENU).length>0&&!cur$.hasClass(C_DISABLED)&&(cur$.hasClass(C_SPLIT_MENU)&&menuManager.isCurrentMenu(cur$.children(SEL_MENU)[0])?(next$=cur$.find("ul").first().children(SEL_ITEM).first(),next$.find(SEL_FOCUSABLE).focus()):openMenu()):kc===keys.UP?movePrev():moveNext(),e.preventDefault();else if(kc===this.forwardKey)isMenuBarItem?(moveNext(),menuManager.closeOpenSiblings(cur$,!0),menuManager.isCurrentMenuBar($ctrl[0])&&cur$.children(SEL_MENU).length>0&&!cur$.hasClass(C_DISABLED)&&openMenu()):(next$=cur$.children(SEL_MENU),next$.length>0&&!cur$.hasClass(C_DISABLED)?(menuManager.openSubMenu(cur$,next$,!1,this.options.slide,!1),next$=next$.find("ul").first().children(SEL_ITEM).first(),setItemFocus(next$)):this.options.menubar&&(cur$=$ctrl.find(SEL_EXPANDED).eq(0),items$=$ctrl.find("."+C_BAR_ITEM),moveNext(),menuManager.closeOpenSiblings(cur$,itemIsMenuBarItem(cur$)),cur$.children(SEL_MENU).length>0&&!cur$.hasClass(C_DISABLED)&&openMenu())),e.preventDefault();else if(kc===self.backwardKey)isMenuBarItem?(movePrev(),menuManager.closeOpenSiblings(cur$,!0),menuManager.isCurrentMenuBar(self.element[0])&&cur$.children(SEL_MENU).length>0&&!cur$.hasClass(C_DISABLED)&&openMenu()):(next$=cur$.parents(SEL_ITEM).eq(0),next$.length>0&&!itemIsMenuBarItem(next$)?menuManager.closeLast(!0):this.options.menubar&&(cur$=$ctrl.find(SEL_EXPANDED).eq(0),items$=$ctrl.find("."+C_BAR_ITEM),movePrev(),menuManager.closeOpenSiblings(cur$,itemIsMenuBarItem(cur$)),cur$.children(SEL_MENU).length>0&&!cur$.hasClass(C_DISABLED)&&openMenu())),e.preventDefault();else if(kc===keys.TAB)isMenuBarItem?("EXIT"===this.options.tabBehavior||e.shiftKey)&&(actionTookFocus=!0,menuManager.closeAll()):(tabBehavior=this.options.tabBehavior,"NEXT"===tabBehavior&&(e.shiftKey?movePrev(!0)||(tabBehavior="EXIT"):moveNext(!0)||(tabBehavior="EXIT")),"EXIT"===tabBehavior&&menuLauncher&&(actionTookFocus=!0,menuManager.closeAll(),tabbable$=$(":tabbable"),this.options.menubar?(index=tabbable$.index($(menuLauncher).find(":tabbable")),0>index&&(index=tabbable$.index(this.element.find(":tabbable")))):index=tabbable$.index(menuLauncher),index>0&&index<tabbable$.length?index+=e.shiftKey?-1:1:tabbable$.length>0&&(index=0),index>=0&&tabbable$[index].focus()),e.preventDefault());else if(kc===keys.ESCAPE)menuManager.closeLast(!0),e.preventDefault();else if(kc===keys.ENTER||kc===keys.SPACE){if(cur$=$ctrl.hasClass(C_FOCUSED)?$ctrl:$ctrl.find(SEL_FOCUSED),cur$.hasClass(C_DISABLED)||!cur$.is(SEL_ITEM))return void e.preventDefault();if(id=cur$[0].id,item=this._getMenuItemFromId(id),type=item.type,isMenuBarItem=itemIsMenuBarItem(cur$),"subMenu"===type&&isMenuBarItem&&(item.action||item.href)&&(type="action",menuManager.closeOpenSiblings(cur$,isMenuBarItem)),"subMenu"===type)isMenuBarItem?(self.toggle(cur$),next$=cur$.find(SEL_MENU_CONTENT).first().find(SEL_ITEM).first(),setItemFocus(next$)):(menu$=cur$.children(SEL_MENU),menu$.length>0&&(menuManager.openSubMenu(cur$,menu$,!1,this.options.slide,!1),next$=menu$.find("ul").first().children(SEL_ITEM).first(),setItemFocus(next$)));else{if(("A"!==e.target.nodeName||kc!==keys.SPACE)&&("action"===type||kc===keys.SPACE&&"BUTTON"===e.target.nodeName))return void(this.keyboardActivate=!0);"display"!==type&&(choice=getChoiceFromId(id),invokeItem(item,choice,this.options,type,kc===keys.SPACE)&&(actionTookFocus=!0,menuManager.closeAll()))}e.preventDefault()}},keypress:function(e){var ch,sp,next$,cur$,ctrl$,thisMenu$,items$,label$,index=-1;if(0!==e.which&&(ctrl$=this.element,ctrl$.hasClass(C_FOCUSED)?(cur$=ctrl$.find(SEL_MENU_CONTENT).first().find(SEL_ITEM).first(),index=0):cur$=ctrl$.find(SEL_FOCUSED),thisMenu$=cur$.closest(SEL_MENU),0!==thisMenu$.length))for(items$=getItemsForMenu(thisMenu$),0>index&&(index=items$.index(cur$)+1,index>=items$.length&&(index=0)),next$=items$.eq(index),ch=String.fromCharCode(e.which).toLowerCase();;){if(label$=next$.filter(".a-Menu-label"),0===label$.length&&(label$=next$.find(".a-Menu-label")),label$.text().charAt(0).toLowerCase()===ch){setItemFocus(next$),sp=getMenuScrollParent(thisMenu$)[0],sp&&this._checkScrollBounds(thisMenu$,sp);break}if(index+=1,index>=items$.length&&(index=0),next$=items$.eq(index),next$[0]===cur$[0])break}},focusin:function(e){var $target=$(e.target);this.isActive||this.element.find(SEL_FOCUSED).removeClass(C_FOCUSED),$target.is(SEL_MENU)?$target.addClass(C_FOCUSED):$target.closest(SEL_ITEM).addClass(C_FOCUSED),this.isActive=!0},focusout:function(e){var $target=$(e.target);$target.is(SEL_MENU)?$target.removeClass(C_FOCUSED):$target.closest(SEL_ITEM).removeClass(C_FOCUSED),this.isActive=!1},focus:function(){this.element.addClass(C_FOCUSED)},blur:function(){this.element.removeClass(C_FOCUSED)}},_destroy:function(){var o=this.options,$ctrl=this.element;isTracking&&(debug.warn("Menu destroyed while still tracking menus."),menuManager.closeAll(!0)),$ctrl.empty().removeClass((o.menubar?C_MENUBAR+" "+C_MENUBAR_TABS:C_MENU)+" "+C_RTL+" "+C_OVERFLOW).removeAttr("role")},_setOption:function(key,value){var overflowItem,items,item,overflowList,o=this.options;if("menubar"===key)throw"The menubar option cannot be set";if(o.menubar?("customContent"===key||"firstItemIsDefault"===key)&&debug.warn("Option "+key+" ignored when menubar is true"):("menubarOverflow"===key||"menubarShowSubMenuIcon"===key||"behaveLikeTabs"===key)&&debug.warn("Option "+key+" ignored when menubar is false"),this._super(key,value),"menubarOverflow"===key&&o.menubar&&(this.element.toggleClass(C_OVERFLOW,value),!value&&(items=o.items,overflowItem=items[items.length-1],overflowItem&&overflowItem._overflow))){for(overflowList=overflowItem.menu.items;overflowList.length>0;)item=overflowList.shift(),"subMenu"===item.type&&(item.action||item.href)&&item.menu.items.shift(),items.splice(items.length-1,0,item);items.pop()}},refresh:function(){var owns,$ctrl=this.element,o=this.options,idprefix=o.idPrefix||$ctrl[0].id||"menu",out=util.htmlBuilder();return o.menubar&&(owns=this._renderMenubar(out,idprefix,o),$ctrl.html(out.toString()),this._processMenuCustomMarkup(),this.resize()),this},resize:function(){var owns,$ctrl=this.element,o=this.options,idprefix=o.idPrefix||$ctrl[0].id||"menu",out=util.htmlBuilder();return o.menubar&&o.menubarOverflow&&this._adjustMenubarForSize(idprefix,o)&&(owns=this._renderMenubar(out,idprefix,o),$ctrl.html(out.toString()),this._processMenuCustomMarkup()),this},toggle:function(x,y){var $menu=this.element;if(this.options.menubar&&($menu=null,"number"==typeof x?(x=this.element.children("ul").children("li").eq(x),x.length>0&&($menu=x.children(SEL_MENU))):x.is(SEL_ITEM)&&($menu=x.children(SEL_MENU)),!$menu||1!==$menu.length))throw"Invalid menu bar menu";return menuManager.isCurrentMenu($menu[0])?menuManager.closeAll():this.open(x,y),this},open:function(x,y){function finish(){var owns;self._trigger("beforeOpen",{},menuArg),menu.customContent?("string"==typeof menu.customContent&&($menu.empty().append($("#"+util.escapeCSS(menu.customContent)).show()),menu.customContent=!0),self._parseCustomMarkup($menu,idprefix,menu)):(out.clear(),owns=self._renderMenu(out,idprefix,menu,isPopup),$menu.html(out.toString()))}var i,menu,$menu,$menubar,idprefix,menuArg,isPopup,isAsync=!1,self=this,o=this.options,out=util.htmlBuilder();if(o.menubar){if($menubar=this.element,$menu=null,"number"==typeof x?(x=this.element.children("ul").children("li").eq(x),x.length>0&&($menu=x.children(SEL_MENU))):x.is(SEL_ITEM)&&($menu=x.children(SEL_MENU)),!$menu||1!==$menu.length)throw"Invalid menu bar menu";if(idprefix=x[0].id,menu=this._getMenuItemFromId(idprefix),!menu||"subMenu"!==menu.type||!menu.menu)throw"Can't open menu "+x;menuArg=menu,menu=menu.menu,isPopup=!1}else $menubar=null,menu=o,menuArg={menu:menu},$menu=this.element,idprefix=o.idPrefix||this.element[0].id||"menu",isPopup=!0;if($.isFunction(o.asyncFetchMenu)){if(!isTracking&&o.menubar)for(i=0;i<o.items.length;i++)o.items[i]._fetched=!1;o.menubar&&menuArg._fetched===!0?finish():(self._renderMenu(out,idprefix,{items:[{type:"action",disabled:!0,label:apex.lang.getMessage("APEX.PROCESSING")}]},isPopup),$menu.html(out.toString()),isAsync=!0,o.asyncFetchMenu(menu,function(status){var focusItem$;if(menuManager.isCurrentMenu($menu[0])){if(status===!1)return void menuManager.closeAll(!0);focusItem$=$menu.find(SEL_FOCUSED).first(),finish(),menuResize(),focusItem$.length?setItemFocus($menu.find(SEL_ITEM).first()):$menu.focus()}}),o.menubar&&(menuArg._fetched=!0))}else finish();return isAsync||0!==menu.items.length?menuManager.openMenu($menu,$menubar,x,y,o.slide,o.menubar||y!==!1):(debug.error("Menu has no items"),self._trigger("afterClose",{},{actionTookFocus:!1,actionTaken:!1,launcher:null})),this},find:function(id){var o=this.options;return findItemById(o,id)},setCurrentMenuItem:function(item){var curItem,prevItem,i=0,menuItems=this.options.items;if(!this.options.menubar||!this.options.behaveLikeTabs)return void debug.warn("setCurrentMenuItem ignored");if("string"==typeof item&&(item=this.find(item)),item){for(i=0;i<menuItems.length;i++)curItem=menuItems[i],curItem.current&&(prevItem=curItem,delete curItem.current),descendentIsCurrent(curItem,!0);for(item.current=!0,i=0;i<menuItems.length;i++)if(curItem=menuItems[i],descendentIsCurrent(curItem)){curItem.current=!0,getLabelFromMessage(prevItem),this.element.find("."+C_CURRENT_MENU).removeClass(C_CURRENT_MENU).find(".a-MenuBar-label").text(prevItem.label),this.element.children("ul").children("li").eq(i).addClass(C_CURRENT_MENU).find(".a-MenuBar-label").append(" <span class='u-VisuallyHidden'>current</span>");break}}},_parseMenuMarkup:function($el,isMenubar){var self=this,menu={items:[]};return $el.children("ul").children("li").each(function(i){var item,icon,index,id,customId,customContent$,$item=$(this),$a=$item.children("a").eq(0),$span=$item.children("span").eq(0);if(item={type:"action"},$a.length>0?(item.label=$a.text(),item.href=$a.attr("href")):$span.length>0?item.label=$span.text():item.type="separator","separator"===item.href&&(item.type="separator",delete item.href,delete item.label),id=$item.attr("data-id"),id&&(item.id=id),"true"===$item.attr("data-hide")&&(item.hide=!0),"true"===$item.attr("data-disabled")&&(item.disabled=!0),"true"===$item.attr("data-current")&&(item.current=!0),icon=$item.attr("data-icon"),icon&&(index=icon.indexOf(" "),index>=0?(item.iconType=icon.substring(0,index),item.icon=icon.substring(index+1)):item.icon=icon),"separator"!==item.type&&($item.children("ul").length>0||"true"===$item.attr("data-custom")))if(item.type="subMenu","true"!==$item.attr("data-custom"))item.menu=self._parseMenuMarkup($item,!1);else{if(!isMenubar)throw"Attribute data-custom only allowed at menubar level";customContent$=$item.children(SEL_MENU_CONTENT).eq(0),customId=customContent$[0].id,customId||(customId=customContent$[0].id=(self.options.idPrefix||self.element[0].id||"menu")+"_cm_"+i),$(document.body).append(customContent$),customContent$.hide(),item.menu={customContent:customId}}"action"===item.type&&id&&apex.actions&&apex.actions.lookup(id)&&(item.action=id,delete item.href,delete item.label,delete item.disabled,delete item.icon,delete item.iconType),menu.items.push(item)}),menu},_parseCustomMarkup:function($menu,idprefix,menu){menu.items||(menu.items=[]),$menu.attr("data-custom","true"),0===$menu.find(SEL_MENU_CONTENT).length&&$menu.children().first().addClass(C_MENU_CONTENT),$menu.find(SEL_FOCUSABLE).each(function(index){var menuId,item,item$,f$;f$=$(this),item$=f$.closest(SEL_MENU_ITEM),f$.attr("role","menuitem"),0===item$.length&&(item$=$(this),item$.addClass(C_ITEM)),item$.hasClass(C_LABEL)||0!==item$.find(SEL_LABEL).length||f$.addClass(C_LABEL),item$[0].id=idprefix+"_"+index,"A"===this.nodeName&&this.href?(item={type:"action",label:f$.text(),href:this.href},menu.items[index]=item):"BUTTON"===this.nodeName?(item={type:"action",label:f$.text(),action:function(){}},menu.items[index]=item):(f$.attr("tabindex","-1"),menu.items[index]||(item={type:"display",label:f$.text(),disabled:!0},menu.items[index]=item)),menuId=item$.attr("data-id"),menuId&&(item.id=menuId,"action"===item.type&&menuId&&apex.actions&&apex.actions.lookup(menuId)&&(item.action=menuId,delete item.href,delete item.label,delete item.disabled,delete item.icon,delete item.iconType))})},_processMenuCustomMarkup:function(){var self=this;this.element.find("."+C_BAR_ITEM).each(function(){var menu$=$(this).children(SEL_MENU),idprefix=this.id,menu=self._getMenuItemFromId(idprefix).menu;menu&&menu.customContent&&("string"==typeof menu.customContent&&(menu$.empty().append($("#"+util.escapeCSS(menu.customContent)).show()),menu.customContent=!0),self._parseCustomMarkup(menu$,idprefix,menu))})},_getMenuItemFromId:function(id){var i,mi,o=this.options,idParts=id.split("_"),path=[],item=null;for(i=idParts.length-1,idParts[i].match(/^c[0-9]+$/)&&(i-=1);i>0&&idParts[i].match(/^[0-9]+$/);i--)path.unshift(1*idParts[i]);for(mi=o.items,i=0;i<path.length;i++){if(item=mi[path[i]],!item||i<path.length-1&&!item.menu)return null;item.menu&&(mi=item.menu.items)}return item},_itemIsHidden:function(item){var hide=item.hide,o=this.options;return $.isFunction(hide)&&(hide=item.hide(o)),hide},_itemIsDisabled:function(item){var disabled=item.disabled,o=this.options;return $.isFunction(disabled)&&(disabled=item.disabled(o)),disabled},_renderMenubar:function(out,idprefix,menubar){var owns="",self=this,focusItem=0,o=this.options,tabAll="NEXT"===o.tabBehavior;return o.behaveLikeTabs&&$.each(menubar.items,function(i,item){return descendentIsCurrent(item)&&(item.current=!0),item.current?(focusItem=i,!1):void 0
}),this.element.find("."+C_MENU_TOP).filter("[data-custom]").each(function(){var save$=$(this).children().eq(0),item=self._getMenuItemFromId(save$.closest(SEL_ITEM)[0].id);item.menu.customContent=save$[0].id,$(document.body).append(save$)}),out.markup("<ul>"),$.each(menubar.items,function(i,item){var label,itemClass,disabled,action,type=item.type,id=idprefix+"_"+i;if("action"===item.type&&"string"==typeof item.action){if(!apex.actions)throw"Action name requires apex.actions";action=apex.actions.lookup(item.action),action?(item.hide=!1,action.label&&!item.label&&(item.label=action.label),action.disabled!==undefined&&(item.disabled=action.disabled)):(debug.warn("Unknown action name "+item.action+" (item hidden)."),item.hide=!0)}if(!self._itemIsHidden(item)){if(itemClass=C_BAR_ITEM,disabled=self._itemIsDisabled(item),disabled&&(itemClass+=" "+C_DISABLED),"subMenu"===item.type&&(item.action||item.href)&&(itemClass+=" "+C_SPLIT_MENU),o.behaveLikeTabs&&item.current&&(itemClass+=" "+C_CURRENT_MENU),item._overflow&&(itemClass+=" "+C_BAR_OVERFLOW),"action"!==type&&"subMenu"!==type)throw"Menu item type not supported in menubar: "+type;out.markup("<li").attr("id",id).attr("class",itemClass).markup(">"),owns+=" "+id+"i",getLabelFromMessage(item),label=item.label,(item.icon||item.iconType)&&debug.warn("Menu bar items cannot have icons."),item.accelerator&&debug.warn("Menu bar items cannot have accelerators."),disabled?out.markup("<span role='menuitem'").attr("class",C_BAR_LABEL).attr("tabindex",tabAll||i===focusItem?"0":"-1").attr("id",id+"i").optionalAttr(A_DISABLED,disabled?"true":null).optionalAttr(A_HASPOPUP,"subMenu"===type?"true":null).markup(">").content(label).markup("</span>"):item.href&&o.useLinks?(out.markup("<a role='menuitem'").attr("class",C_BAR_LABEL).attr("id",id+"i").attr("href",item.href).optionalAttr("tabindex",tabAll||i===focusItem?null:"-1").optionalAttr(A_HASPOPUP,"subMenu"===type?"true":null).markup(">").content(label),o.behaveLikeTabs&&item.current&&out.markup(" <span class='u-VisuallyHidden'>current</span>"),out.markup("</a>")):(out.markup("<button type='button' role='menuitem'").attr("class",C_BAR_LABEL).attr("id",id+"i").optionalAttr("tabindex",tabAll||i===focusItem?null:"-1").optionalAttr(A_HASPOPUP,"subMenu"===type?"true":null),item._overflow?out.attr("title",label).markup("><span class='a-Icon icon-down-chevron'></span>"):(out.markup(">").content(label),o.behaveLikeTabs&&item.current&&out.markup(" <span class='u-VisuallyHidden'>current</span>")),out.markup("</button>")),"subMenu"===type&&((item.action||item.href||o.menubarShowSubMenuIcon)&&!item._overflow&&(out.markup("<span class='"+C_SUBMENU_COL+"'>"),renderIcon(out,C_DEFAULT_ICON_TYPE,!o.menubarShowSubMenuIcon||item.action||item.href?"icon-menu-split-drop-down":"icon-menu-drop-down"),out.markup("</span>")),out.markup("<div").attr("id",id+"m").markup(" class='"+C_MENU+" "+C_MENU_TOP+"' role='menu' tabindex='-1' style='display:none;'></div>")),out.markup("</li>")}}),out.markup("</ul>"),$.trim(owns)},_renderMenu:function(out,idprefix,menu,isPopup){function separator(){delayAddSeparator=!1,itemCount>0&&(out.markup("<li class='").markup(C_ITEM_SEP).markup("' role='separator'><div class='a-Menu-inner'><span class='a-Menu-labelContainer'><span class='").markup(C_STATUS_COL).markup("'></span><span class='").markup(C_HSEP).markup("'></span></span><span class='a-Menu-accelContainer'></span></div></li>"),itemCount+=1)}function statusColumn(type,icon){out.markup("<span class='"+C_STATUS_COL+"'>"),(icon||""===icon)&&renderIcon(out,type,icon),out.markup("</span>")}function labelAccel(accelerator){out.markup("<span").attr("class",C_ACCEL).markup("> ").content(accelerator).markup("</span>")}function labelColumn(id,disabled,label,accelerator,href,role,checked,submenu){var closeTag;disabled?(out.markup("<span tabindex='-1'").optionalAttr(A_DISABLED,disabled?"true":null),closeTag="</span>"):href&&o.useLinks?(out.markup("<a").attr("href",href),closeTag="</a>"):(out.markup("<button type='button'"),closeTag="</button>"),out.attr("id",id).attr("role",role).attr("class",C_LABEL).optionalAttr(A_HASPOPUP,submenu?"true":null).optionalAttr(A_CHECKED,null!==checked&&checked?"true":null).markup(">"),out.content(label),accelerator&&out.markup(" <span class='u-VisuallyHidden'>").content(accelerator).markup("</span>"),out.markup(closeTag).markup("</span><span class='a-Menu-accelContainer'>"),accelerator&&labelAccel(accelerator)}function noSubMenu(){out.markup("<span class='"+C_SUBMENU_COL+"'></span>")}var owns="",o=this.options,self=this,isRtl=this.element.hasClass(C_RTL),delayAddSeparator=!1,itemCount=0,subMenuIcon="icon-menu-sub";return isRtl&&(subMenuIcon="icon-menu-sub-rtl"),out.markup("<div class='"+C_MENU_CONTENT+"'><ul>"),$.each(menu.items,function(i,item){var state,label,itemClass,icon,iconType,disabled,role,accelerator,labelId,subOut,subOwns,action=null,type=item.type,id=idprefix+"_"+i;if(getLabelFromMessage(item),icon=item.icon,iconType=item.iconType,label=item.label,accelerator=item.accelerator,("action"===item.type||"toggle"===item.type)&&"string"==typeof item.action){if(!apex.actions)throw"Action name requires apex.actions";action=apex.actions.lookup(item.action),action?(item.hide=!1,action.icon&&!item.icon&&(icon=action.icon),action.iconType&&!item.iconType&&(iconType=action.iconType),action.label&&!item.label&&(label=action.label),action.shortcut&&!item.accelerator&&(accelerator=action.shortcut),action.disabled!==undefined&&(item.disabled=action.disabled)):(debug.warn("Unknown action name "+item.action+" (item hidden)."),item.hide=!0)}self._itemIsHidden(item)||(itemClass="separator"===type?C_ITEM_SEP:C_ITEM,disabled=self._itemIsDisabled(item),disabled&&(itemClass+=" "+C_DISABLED),0===i&&isPopup&&o.firstItemIsDefault&&(itemClass+=" "+C_ITEM_DEFAULT),"radioGroup"===type?(delayAddSeparator=!0,state=item.get(),$.each(item.choices,function(j,choice){var rid=id+"_c"+j,checked=state===choice.value;itemClass=C_ITEM,disabled=choice.disabled,$.isFunction(disabled)&&(disabled=choice.disabled(o)),disabled&&(itemClass+=" "+C_DISABLED),choice.icon&&debug.warn("Radio menu items cannot have icons."),delayAddSeparator&&separator(),out.markup("<li").attr("id",rid).attr("class",itemClass).markup("><div class='a-Menu-inner'><span class='a-Menu-labelContainer'>"),statusColumn(C_DEFAULT_ICON_TYPE,checked?"icon-menu-radio":""),getLabelFromMessage(choice),labelId=rid+"i",owns+=" "+labelId,labelColumn(labelId,disabled,choice.label,null,null,"menuitemradio",checked),noSubMenu(),out.markup("</span></div></li>"),itemCount+=1}),delayAddSeparator=!0):"separator"===type?delayAddSeparator=!0:(role="toggle"===type?"menuitemcheckbox":"menuitem",delayAddSeparator&&separator(),labelId=id+"i",out.markup("<li id='").attr(id).markup("' class='").attr(itemClass).markup("'><div class='a-Menu-inner'><span class='a-Menu-labelContainer'>"),"action"===type||"display"===type?(statusColumn(iconType||o.iconType,icon),labelColumn(labelId,disabled,label,accelerator,item.href||"",role,null),noSubMenu(),out.markup("</span></div>")):"toggle"===type?(action&&(item=action),state=item.get(),item.icon&&!action&&debug.warn("Toggle menu items cannot have icons."),item.label&&(item.onLabel||item.offLabel)&&debug.warn("Toggle menu items should not have both label and on/offLabel properties."),label=item.label,icon=state?"icon-menu-check":"",label||(icon=null,label=state?item.onLabel:item.offLabel,role="menuitem",state=null),statusColumn(C_DEFAULT_ICON_TYPE,icon),labelColumn(labelId,disabled,label,accelerator,null,role,state),noSubMenu(),out.markup("</span></div>")):"subMenu"===type&&(statusColumn(item.iconType||o.iconType,item.icon),labelColumn(labelId,disabled,item.label,null,"",role,null,!0),item.accelerator&&debug.warn("Sub menu items cannot have accelerators."),out.markup("<span class='"+C_SUBMENU_COL+"'>"),renderIcon(out,C_DEFAULT_ICON_TYPE,subMenuIcon),out.markup("</span></span></div>"),subOut=util.htmlBuilder(),subOwns=self._renderMenu(subOut,id,item.menu,!1),out.markup("<div class='"+C_MENU+"' role='menu' tabindex='-1'").attr("id",labelId+"m").markup(">"+subOut.toString()),out.markup("</div>")),owns+=" "+labelId,out.markup("</li>"),itemCount+=1))}),out.markup("</ul></div>"),$.trim(owns)},_checkScrollBounds:function($menu,sp){return $menu.find(SEL_MENU_SCROLL_BTN).removeClass(C_DISABLED),sp.scrollTop<=0?($menu.find(SEL_MENU_SCROLL_BTN+"."+C_UP).addClass(C_DISABLED),sp.scrollTop=0,!0):sp.scrollTop>=sp.scrollHeight-sp.clientHeight?($menu.find(SEL_MENU_SCROLL_BTN+"."+C_DOWN).addClass(C_DISABLED),sp.scrollTop=sp.scrollHeight-sp.clientHeight,!0):!1},_startScrolling:function($menu,up){function scroll(){return sp.scrollTop+=up?-10:10,self._checkScrollBounds($menu,sp)?void self._stopScrolling():(self.scrollTimerId=setTimeout(function(){scroll()},times[timeIndex]),void(timeIndex<times.length-1&&(timeIndex+=1)))}var self=this,timeIndex=0,times=[100,99,96,91,84,75,64,51,36,19],sp=getMenuScrollParent($menu)[0];this.scrollTimerId&&this._stopScrolling(),$(document).on("mouseup.menuScrolling",function(){self._stopScrolling()}).on("mousemove.menuScrolling",function(event){0===$(event.target).closest(SEL_MENU_SCROLL_BTN).length&&self._stopScrolling()}),scroll()},_stopScrolling:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null,this.element.find(SEL_MENU_SCROLL_BTN).removeClass(C_ACTIVE),$(document).off(".menuScrolling")},_adjustMenubarForSize:function(idprefix,menubar){var i,overflowList,item,count,overflowItem,save$,item$,adjusted=!1,itemsWidth=0,barWidth=this.element.width()-2,items=menubar.items;for(overflowItem=items[items.length-1],overflowItem&&overflowItem._overflow||(overflowItem=null),i=0;i<items.length;i++)item=items[i],item._width=item.hide?0:$("#"+util.escapeCSS(idprefix+"_"+i)).outerWidth(!0),itemsWidth+=item._width;if(itemsWidth>barWidth)for(overflowItem||(overflowItem={type:"subMenu",_overflow:!0,label:lang.getMessage("APEX.MENU.OVERFLOW_LABEL"),menu:{items:[]}},items.push(overflowItem)),overflowList=overflowItem.menu.items,i=items.length-2;i>=0&&itemsWidth>barWidth;)item=items[i],items.splice(i,1),"subMenu"===item.type&&(item.action||item.href)&&item.menu.items.unshift({type:"action",label:item.label,labelKey:item.labelKey,href:item.href,action:item.action,disabled:item.disabled}),"subMenu"===item.type&&item.menu.customContent&&(item$=$("#"+util.escapeCSS(idprefix+"_"+i)),save$=item$.children(SEL_MENU).children().eq(0),save$.hide(),item.menu.customContent=save$[0].id,$(document.body).append(save$),item$.children(SEL_MENU).attr("data-custom",null)),overflowList.unshift(item),itemsWidth-=item._width!==undefined?item._width:0,adjusted=!0,i-=1;else if(overflowItem){for(overflowList=overflowItem.menu.items,count=0,i=0;i<overflowList.length&&3>count;i++)overflowList[i]._width>0&&(count+=1);for(1===count&&(itemsWidth-=this.element.find("."+C_BAR_OVERFLOW).outerWidth(!0)),delete overflowItem.current;overflowList.length>0&&(item=overflowList[0],itemsWidth+=item._width!==undefined?item._width:0,!(itemsWidth>barWidth));)overflowList.shift(),"subMenu"===item.type&&(item.action||item.href)&&item.menu.items.shift(),items.splice(items.length-1,0,item),adjusted=!0;0===overflowList.length&&items.pop()}return adjusted}}),$.ui.dialog&&$.widget("ui.dialog",$.ui.dialog,{_allowInteraction:function(event){return $(event.target).closest(SEL_MENU).length>0||this._super(event)}}),$(document).ready(function(){function toggleMenu(btn$,focus,openOnly){var $menu,menuId=btn$.attr("data-menu");menuId&&(btn$.addClass(C_ACTIVE).attr(A_EXPANDED,"true"),$menu=$("#"+util.escapeCSS(menuId)),openOnly&&menuManager.isCurrentMenu($menu[0])||$menu.menu("toggle",btn$,!1).on("menuafterclose.menubutton",function(){$(this).off(".menubutton"),btn$.removeClass(C_ACTIVE).attr(A_EXPANDED,"false")}),focus&&setItemFocus($menu.find(SEL_ITEM).first()))}$("body").on("click",SEL_MENUBUTTON,function(){toggleMenu($(this),!0,!1)}).on("keydown",SEL_MENUBUTTON,function(e){e.which===keys.DOWN?(e.preventDefault(),toggleMenu($(this),!0,!0)):e.which===keys.TAB&&(actionTookFocus=!0,menuManager.closeAll())}),$(SEL_MENUBUTTON).attr(A_HASPOPUP,"true").attr(A_EXPANDED,"false"),$("body").on("apexafterrefresh",function(event){$(event.target).find(SEL_MENUBUTTON).attr(A_HASPOPUP,"true").attr(A_EXPANDED,"false")})})}(apex.util,apex.debug,apex.lang,apex.jQuery);