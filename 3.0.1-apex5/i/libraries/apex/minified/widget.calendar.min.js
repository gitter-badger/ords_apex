(null===apex.widget.calendar||"object"!=typeof apex.widget.calendar)&&(apex.widget.calendar={}),apex.widget.calendar={ajax_calendar:function(p_calendar_type,p_calendar_action,p_calendar_date,p_calendar_end_date,pOptions){var l_cal_type_field=$v("p_cal_type_field_id"),l_cal_date_field=$v("p_cal_date_field_id"),l_cal_end_date_field=$v("p_cal_end_date_field_id"),l_cal_id=$v("p_calendar_id"),l_calendar_region=apex.util.escapeCSS("calendar"+l_cal_id),l_cal_enable_drag_add=$v("p_cal_enable_drag_add"),l_cal_enable_drag_drop=l_cal_enable_drag_add.charAt(0),l_cal_enable_data_add=l_cal_enable_drag_add.charAt(1),l_cal_highlight_data=(l_cal_enable_drag_add.charAt(2),$v("p_cal_highlight_data"));"C"!=p_calendar_type?$s(l_cal_date_field,$v("p_calendar_date")):(""==$v(l_cal_date_field)&&$s(l_cal_date_field,$v("p_calendar_date")),""==$v(l_cal_end_date_field)&&$s(l_cal_end_date_field,$v("p_calendar_end_date"))),"S"==p_calendar_type?p_calendar_type=$v("p_calendar_type"):$s(l_cal_type_field,p_calendar_type);var lDate=p_calendar_date&&""!==p_calendar_date?p_calendar_date:$v(l_cal_date_field);if("C"==p_calendar_type)var lendDate=p_calendar_end_date&&""!==p_calendar_end_date?p_calendar_end_date:$v(l_cal_end_date_field);var lOptions=apex.jQuery.extend({dataType:"html",refreshObject:"#"+l_calendar_region,success:function(pData){apex.jQuery("#"+l_calendar_region,apex.gPageContext$).html(pData),$s(l_cal_date_field,$v("p_calendar_date")),"C"==p_calendar_type&&$s(l_cal_end_date_field,$v("p_calendar_end_date")),"Y"==l_cal_enable_drag_drop&&apex.widget.calendar.initDragDrop(),"Y"==l_cal_enable_data_add&&apex.widget.calendar.initAjaxDataAdd(),apex.widget.calendar.initAjaxDataModify(),"Y"==l_cal_highlight_data&&loadCalendarData(),"Y"==$v("p_cal_is_mobile")&&apex.jQuery("#"+l_calendar_region,apex.gPageContext$).find('[data-role="listview"]').listview(),document.body.style.cursor=""}},pOptions);apex.server.widget("calendar",{p_widget_action:p_calendar_action,p_widget_mod:p_calendar_type,x01:l_cal_id,x02:lDate,x05:lendDate},lOptions)},initAjaxDataModify:function(){apex.jQuery("div.apex_cal_data_grid_src",apex.gPageContext$).bind("click",function(e){apex.jQuery(this).find("input.apex_cal_date_source");gMouseX=e.clientX,gMouseY=e.clientY}),apex.jQuery("div.apex_cal_data_grid_src",apex.gPageContext$).bind("mouseenter",function(){this.style.cursor="pointer"})},ajaxAddData:function(e){var lAddUrlnew;if(lAddUrlnew=apex.jQuery(e.target).find("input.apex_cal_add_url").val(),(void 0==lAddUrlnew||""==lAddUrlnew)&&(lAddUrlnew=apex.jQuery(e.target).parent().find("input.apex_cal_add_url").val()),void 0!=lAddUrlnew&&""!=lAddUrlnew){var lOpenPopup=apex.jQuery("#p_cal_url_new_window",apex.gPageContext$).val();""!=lAddUrlnew&&("P"==lOpenPopup?apex.navigation.popup({url:lAddUrlnew,name:"popupwindow",width:800,height:600}):window.location.href=lAddUrlnew)}},initAjaxDataAdd:function(){var lAddUrlnew,lAddUrl=apex.jQuery("#p_cal_add_url",apex.gPageContext$).val(),lOpenPopup=apex.jQuery("#p_cal_url_new_window",apex.gPageContext$).val();-1!=lAddUrl.indexOf("#DATE_VALUE#")&&apex.jQuery(".calDragDrop",apex.gPageContext$).parent().bind("click",function(e){if("A"!=e.target.nodeName&&"apex_cal_data_grid_src"!=e.target.id){var lDateVal=apex.jQuery(this).find("input.apex_cal_grid_target").val();lAddUrl=lAddUrl.replace("#DATE_VALUE#",lDateVal),lAddUrlnew=apex.jQuery(this).find("input.apex_cal_add_url").val(),"P"==lOpenPopup?apex.navigation.popup({url:lAddUrlnew,name:"popupwindow",width:800,height:600}):window.location.href=lAddUrlnew}}),apex.jQuery(".calDragDrop",apex.gPageContext$).parent().bind("mouseenter",function(){this.style.cursor="pointer"})},initAjaxDataShow:function(){apex.jQuery(".calDragDrop",apex.gPageContext$).parent().bind("click",function(){var lDateVal=apex.jQuery(this).find("input.apex_cal_grid_target").val();""!=lDateVal&&apex.widget.calendar.show(apex.jQuery(this),lDateVal)})},initDragDrop:function(){var lCalendarDataDrag=apex.jQuery("#calendar_data_drag",apex.gPageContext$);apex.jQuery("div.apex_cal_data_grid_src",lCalendarDataDrag).draggable({revert:"invalid",helper:function(){var lDraggable=apex.jQuery(this).clone().width(this.clientWidth);return lDraggable},cursor:"move",dragstart:function(){apex.jQuery(this).height(180),apex.jQuery(this).width(181)}}),apex.jQuery("div.calDragDrop",lCalendarDataDrag).parent().droppable({accept:"#calendar_data_drag div.apex_cal_data_grid_src",activeClass:"custom-state-active",drop:function(ev,ui){apex.widget.calendar.move(this,ev,ui.draggable)}})},move:function(pThis,pEvent,pItem,pOptions){var lCalDateField=($v("p_cal_type_field_id"),$v("p_cal_date_field_id")),lCalEndDateField=$v("p_cal_end_date_field_id"),lTarget=apex.jQuery(pThis),lKeyValue=pItem.find("input.apex_cal_date_source").val(),lTargetDate=lTarget.find("input.apex_cal_grid_target").val();$s(lCalDateField,$v("p_calendar_date"));var lCalId=$v("p_calendar_id"),lCalendarRegion="calendar"+lCalId,l_cal_enable_drag_add=$v("p_cal_enable_drag_add"),l_cal_enable_drag_drop=l_cal_enable_drag_add.charAt(0),l_cal_enable_data_add=l_cal_enable_drag_add.charAt(1),l_cal_highlight_data=(l_cal_enable_drag_add.charAt(2),$v("p_cal_highlight_data")),l_page_process=$v("p_cal_drag_process");if(""!=l_page_process){var ajax=new htmldb_Get(null,$v("pFlowId"),"APPLICATION_PROCESS="+l_page_process,$v("pFlowStepId"));ajax.addParam("x01",lTargetDate),ajax.addParam("x02",lKeyValue);{ajax.get(null,"<htmldb:BOX_BODY>","</htmldb:BOX_BODY>")}ajax=null}var lDate=$v(lCalDateField);if("C"==$v("p_calendar_type"))var lendDate=$v(lCalEndDateField);var lOptions=apex.jQuery.extend({dataType:"html",refreshObject:"#"+lCalendarRegion,success:function(pData){apex.jQuery("#"+lCalendarRegion,apex.gPageContext$).html(pData),$s(lCalDateField,$v("p_calendar_date")),"C"==$v("p_calendar_type")&&$s(lCalEndDateField,$v("p_calendar_end_date")),"Y"==l_cal_enable_drag_drop&&apex.widget.calendar.initDragDrop(),"Y"==l_cal_enable_data_add&&apex.widget.calendar.initAjaxDataAdd(),apex.widget.calendar.initAjaxDataModify(),"Y"==l_cal_highlight_data&&loadCalendarData(),document.body.style.cursor=""}},pOptions);apex.server.widget("calendar",{p_widget_action:"same",p_widget_mod:$v("p_calendar_type"),x01:lCalId,x02:lDate,x03:$v("apex_cal_table_name"),x05:lendDate,x06:$v("apex_cal_primary_key"),x07:lKeyValue,x08:$v("p_date_column_name"),x09:lTargetDate},lOptions)},getDayData:function(pRegionId,pDate,pOptions){var lOptions=apex.jQuery.extend({dataType:"html",refreshObject:"#"+pRegionId},pOptions);apex.server.widget("calendar",{p_widget_action:"DAY_DATA",x01:pRegionId,x02:pDate},lOptions)}},ajax_calendar=apex.widget.calendar.ajax_calendar;