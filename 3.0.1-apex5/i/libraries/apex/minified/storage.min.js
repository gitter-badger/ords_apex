apex.storage={},function(storage,$,undefined){"use strict";function makeDomStorage(check,store,options){var that;return check()?(that=Object.create(storagePrototype),that.prefix=makeKeyPrefix(options),that._store=store,that._re=new RegExp("^"+that.prefix),that.length=countKeys(that._store,that._re)):(that=Object.create(noopStoragePrototype),that.prefix=makeKeyPrefix(options)),that}function makeKeyPrefix(options){var prefix=(options.prefix||"")+".";return(options.useAppId===undefined||null===options.AppId)&&(options.useAppId=!0),options.useAppId&&(prefix+=$("#pFlowId").val()+"."),options.usePageId&&(prefix+=$("#pFlowStepId").val()+"."),options.regionId&&(prefix+=options.regionId+"."),prefix}function countKeys(store,re){var i,count=0;for(i=0;i<store.length;i++)re.test(store.key(i))&&(count+=1);return count}storage.getCookieVal=function(pOffset){var lEndPos=document.cookie.indexOf(";",pOffset);return-1===lEndPos&&(lEndPos=document.cookie.length),unescape(document.cookie.substring(pOffset,lEndPos))},storage.getCookie=function(pName){for(var lArg=pName+"=",lArgLength=lArg.length,lCookieLength=document.cookie.length,i=0;lCookieLength>i;){var j=i+lArgLength;if(document.cookie.substring(i,j)===lArg)return storage.getCookieVal(j);if(i=document.cookie.indexOf(" ",i)+1,0===i)break}return null},storage.setCookie=function(pName,pValue){var argv=arguments,argc=arguments.length,expires=argc>2?argv[2]:null,path=argc>3?argv[3]:null,domain=argc>4?argv[4]:null,secure=argc>5?!0:!1;document.cookie=pName+"="+escape(pValue)+(null===expires?"":"; expires="+expires.toGMTString())+(null===path?"":"; path="+path)+(null===domain?"":"; domain="+domain)+(secure===!0||"https:"===window.location.protocol?"; secure":"")},storage.hasLocalStorageSupport=function(){var localStorageSupport=null,test="$test$";return function(){if(null!==localStorageSupport)return localStorageSupport;if(window.Modernizr&&window.Modernizr.hasOwnProperty("localstorage"))localStorageSupport=Modernizr.localstorage;else try{localStorage.setItem(test,test),localStorage.removeItem(test),localStorageSupport=!0}catch(e){localStorageSupport=!1}return localStorageSupport}}(),storage.hasSessionStorageSupport=function(){var sessionStorageSupport=null,test="$test$";return function(){if(null!==sessionStorageSupport)return sessionStorageSupport;if(window.Modernizr&&window.Modernizr.hasOwnProperty("sessionstorage"))sessionStorageSupport=Modernizr.localstorage;else try{sessionStorage.setItem(test,test),sessionStorage.removeItem(test),sessionStorageSupport=!0}catch(e){sessionStorageSupport=!1}return sessionStorageSupport}}();var storagePrototype={prefix:"",length:0,key:function(index){var i,k,scopeIndex=0;if(index<this._store.length)for(i=0;i<this._store.length;i++)if(k=this._store.key(i),this._re.test(k)){if(index===scopeIndex)return k;scopeIndex+=1}return null},getItem:function(key){return this._store.getItem(this.prefix+key)},setItem:function(key,data){var old=this.getItem(key);this._store.setItem(this.prefix+key,data),null===old&&(this.length+=1)},removeItem:function(key){var old=this.getItem(key);this._store.removeItem(this.prefix+key),null!==old&&(this.length-=1)},clear:function(){var i,k;for(i=0;i<this._store.length;i++)k=this._store.key(i),this._re.test(k)&&this._store.removeItem(k);this.length=0},sync:function(){this.length=countKeys(this._store,this._re)}},noopStoragePrototype={prefix:"",length:0,key:function(){return null},getItem:function(){return null},setItem:function(){},removeItem:function(){},clear:function(){}};storage.getScopedSessionStorage=function(options){return makeDomStorage(storage.hasSessionStorageSupport,window.sessionStorage,options)},storage.getScopedLocalStorage=function(options){return makeDomStorage(storage.hasLocalStorageSupport,window.localStorage,options)}}(apex.storage,apex.jQuery);