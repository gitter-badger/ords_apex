var ToggleCore=function(pOptions){var browserHasLocalStorage=function(){return"Modernizr"in window?Modernizr.localstorage?!0:!1:"localStorage"in window};return function(){var key=pOptions.key,defaultPreference=pOptions.defaultPreference,onExpand=pOptions.onExpand,onCollapse=pOptions.onCollapse,onResize=pOptions.onResize,onInitialize=pOptions.onInitialize,content=pOptions.content,contentClassExpanded=pOptions.contentClassExpanded,contentClassCollapsed=pOptions.contentClassCollapsed,controllingElement=pOptions.controllingElement,controllingElementSelector=pOptions.controllingElementSelector,STORED_PREFERENCE_KEY=key+"_preferenceForExpanded",expanded=!1,userPreference=defaultPreference;if(browserHasLocalStorage()){var storedContractedPreference=localStorage.getItem(STORED_PREFERENCE_KEY);void 0!=storedContractedPreference&&(userPreference="true"==storedContractedPreference)}(!controllingElement||controllingElement.length<1)&&(controllingElement=$(controllingElementSelector)),controllingElement.click(function(pEvent){toggle(),pEvent.preventDefault()});var setUserPreference=function(pUserPreference){userPreference=pUserPreference,browserHasLocalStorage()&&localStorage.setItem(STORED_PREFERENCE_KEY,userPreference)};void 0==onResize&&(onResize=function(){}),void 0==onInitialize&&(onInitialize=function(){this.doesUserPreferExpanded()?this.expand():this.collapse()});var expand=function(pUserWantsToSetPreference){expanded||(expanded=!0,pUserWantsToSetPreference&&setUserPreference(expanded),content.removeClass(contentClassCollapsed).addClass(contentClassExpanded),onExpand())},collapse=function(pUserWantsToSetPreference){expanded&&(expanded=!1,pUserWantsToSetPreference&&setUserPreference(expanded),content.addClass(contentClassCollapsed).removeClass(contentClassExpanded),onCollapse())},toggle=function(){expanded?collapse.call(toggleCore,!0):expand.call(toggleCore,!0)},toggleCore={key:key,doesUserPreferExpanded:function(){return userPreference},isExpanded:function(){return expanded},toggle:function(){toggle.call(toggleCore)},expand:function(){expand.call(toggleCore)},collapse:function(){collapse.call(toggleCore)},resize:function(){onResize.call(toggleCore)},initialize:function(){onInitialize.call(toggleCore)}};return toggleCore}()};