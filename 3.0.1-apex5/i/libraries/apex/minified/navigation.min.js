apex.navigation={},function(navigation,util,$,undefined){"use strict";var DIALOG_DIV_ID="apex_dialog_",INTERNAL_CLOSE_EVENT="apexclosedialoginternal";navigation.redirect=function(pWhere){$.mobile&&pWhere.substring(0,pWhere.indexOf(":"))==="f?p="+$v("pFlowId")?$(":mobile-pagecontainer").pagecontainer("change",pWhere,{reload:!0}):location.href=pWhere},navigation.popup=function(pOptions){var lOptions=$.extend({url:"about:blank",name:"_blank",width:600,height:600,scroll:"yes",resizable:"yes",toolbar:"no",location:"no",statusbar:"no",menubar:"no"},pOptions),lWindow=window.open(lOptions.url,"_blank"===(lOptions.name+"").toLowerCase()?lOptions.name:lOptions.name+"_"+$v("pInstance"),"toolbar="+lOptions.toolbar+",scrollbars="+lOptions.scroll+",location="+lOptions.location+",status="+lOptions.statusbar+",menubar="+lOptions.menubar+",resizable="+lOptions.resizable+",width="+lOptions.width+",height="+lOptions.height);return lWindow&&(null===lWindow.opener&&(lWindow.opener=window.self),lWindow.focus()),lWindow},navigation.openInNewWindow=function(pURL,pWindowName,pOptions){var other,features,altSuffix=pOptions?pOptions.altSuffix||null:null;return pWindowName===undefined&&(pWindowName="_blank"),"_blank"!==pWindowName.toLowerCase()&&(null===altSuffix&&(altSuffix=$v("pInstance")),altSuffix&&(pWindowName+="_"+altSuffix)),pOptions&&pOptions.favorTabbedBrowsing===!0||(features=/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())?"personalbar,menubar,titlebar,toolbar,location,resizable,scrollbars":"personalbar,menubar,titlebar,toolbar,location,status,resizable,scrollbars"),other=features?window.open(pURL,pWindowName,features):window.open(pURL,pWindowName),other&&other.focus(),other},navigation.popup.url=function(pURL){navigation.popup({url:pURL,name:"winLov",width:800,height:600})},navigation.popup.close=function(pItem,pValue){window.opener.$x_Value(pItem,pValue),window.close()},util.getTopApex().navigation._gNextDialogId||(util.getTopApex().navigation._gNextDialogId=1),navigation.dialog=function(pUrl,pOptions,pCssClasses,pTriggeringElement){var lTriggeringElement$,lDialog$,lDialogId,lPopupWindow,lWindowName,lDefaults={width:500,maxWidth:1500,height:500,closeText:apex.lang.getMessage("APEX.DIALOG.CLOSE"),modal:!0,resizable:!1,scroll:"auto",closeOnEscape:!0,close:function(){util.getTopApex().jQuery(this).dialog("destroy").remove()},dialog:null,dialogClass:"ui-dialog--apex"},lOptions=$.extend(lDefaults,pOptions);pOptions.dialogClass&&(lOptions.dialogClass="ui-dialog--apex "+pOptions.dialogClass),pCssClasses&&(lOptions.dialogClass+=" "+pCssClasses),$.mobile?null===lOptions.dialog?(lTriggeringElement$=$(pTriggeringElement,apex.gPageContext$),$.mobile&&pUrl.substring(0,pUrl.indexOf(":"))==="f?p="+$v("pFlowId")&&(navigation.redirect(pUrl),navigation.dialog.registerCloseHandler({handler$:lTriggeringElement$,dialog:$(".ui-dialog"),triggeringElement$:lTriggeringElement$,closeFunction:function(){navigation.redirect(pTriggeringElement.context.URL)}}))):$(window.parent.location).attr("href",pUrl):(lTriggeringElement$=$(pTriggeringElement,apex.gPageContext$),lOptions.modal?null===lOptions.dialog?(lDialogId=DIALOG_DIV_ID+util.getTopApex().navigation._gNextDialogId,util.getTopApex().navigation._gNextDialogId+=1,lDialog$=util.getTopApex().jQuery('<div id="'+lDialogId+'"><iframe src="'+util.escapeHTMLAttr(pUrl)+'"title="'+util.escapeHTMLAttr(lOptions.title)+'" width="100%" height="100%" style="min-width: 95%;height:100%;" scrolling="'+util.escapeHTMLAttr(lOptions.scroll)+'"></iframe></div>'),lDialog$.on("dialogcreate",function(){$(this).closest(".ui-dialog").css("position","fixed")}).on("dialogopen",function(){lOptions.modal&&util.getTopApex().navigation.beginFreezeScroll(),lDialog$.children("iframe").on("load",function(){$(this.contentDocument.body).on("keydown",function(event){if(event.which===$.ui.keyCode.ESCAPE)lDialog$.dialog("close");else if(event.which===$.ui.keyCode.TAB){var pageLast=$(this).find(":tabbable").last(),first=lDialog$.closest(".ui-dialog").find(":tabbable").first();event.target!==pageLast[0]||event.shiftKey||(first.focus(1),event.preventDefault())}})})}).on("dialogclose",function(){lOptions.modal&&util.getTopApex().navigation.endFreezeScroll()}).on("dialogresize",function(){var h=lDialog$.height(),w=lDialog$.width();lDialog$.closest(".ui-dialog").css("position","fixed"),lDialog$.children("iframe").width(w).height(h)}),lDialog$.dialog(lOptions),lDialog$.closest(".ui-dialog").on("keydown",function(event){if(event.keyCode===$.ui.keyCode.TAB){var pageTabbables=$(lDialog$.children("iframe")[0].contentDocument.body).find(":tabbable"),pageFirst=pageTabbables.filter(":first"),pageLast=pageTabbables.filter(":last"),tabbables=$(this).find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");event.target!==last[0]&&event.target!==lDialog$[0]||event.shiftKey?event.target!==first[0]&&event.target!==lDialog$[0]||!event.shiftKey||(pageLast.focus(1),event.preventDefault()):(pageFirst.focus(1),event.preventDefault())}}),navigation.dialog.registerCloseHandler({handler$:lDialog$,dialog:lDialog$,triggeringElement$:lTriggeringElement$,closeFunction:function(){lDialog$.dialog("close")}})):lOptions.dialog.dialog("option","title",lOptions.title).children("iframe").attr("src",pUrl):null===lOptions.dialog?(lWindowName=lTriggeringElement$.id!==undefined&&lTriggeringElement$[0].id!==undefined&&""!==lTriggeringElement$[0].id&&lTriggeringElement$?lTriggeringElement$[0].id:"winDialog",lPopupWindow=navigation.popup({url:pUrl,name:lWindowName,width:lOptions.width,height:lOptions.height}),navigation.dialog.registerCloseHandler({handler$:lTriggeringElement$,dialog:lPopupWindow,triggeringElement$:lTriggeringElement$,closeFunction:function(){lPopupWindow.close()}})):(lOptions.dialog.location.href=pUrl,lOptions.dialog.resizeTo(lOptions.width,lOptions.height)))},navigation.dialog.close=function(pIsModal,pAction){function apexCheck(){try{if(window.opener.apex&&window.opener.apex.jQuery)return!0}catch(ex){return!1}return!1}function getValuesForItems(pItemNames){var i,val,name,lItems={};for(i=0;i<pItemNames.length;i++)name=pItemNames[i],val=$v(name),lItems[name]=val;return lItems}var lTriggeringId;$.isArray(pAction)&&(pAction=getValuesForItems(pAction)),$.mobile?$.isFunction(pAction)?pAction.call(this,window):navigation.redirect(apex.jQuery.ajaxSettings.url):pIsModal?navigation.dialog.fireCloseHandler(util.getTopApex().jQuery(".ui-dialog--apex").last().children(".ui-dialog-content"),pAction):window.opener&&!window.opener.closed&&apexCheck()?(lTriggeringId=window.name,lTriggeringId.lastIndexOf("_")>0&&(lTriggeringId=lTriggeringId.substring(0,lTriggeringId.lastIndexOf("_"))),lTriggeringId===undefined?window.close():"winDialog"===lTriggeringId?$.isFunction(pAction)?pAction.call(this,window):window.close():navigation.dialog.fireCloseHandler(window.opener.apex.jQuery("#"+lTriggeringId),pAction)):$.isFunction(pAction)?pAction.call(this,window):window.close()},navigation.dialog.cancel=function(pIsModal){navigation.dialog.close(pIsModal,!1)},navigation.dialog.registerCloseHandler=function(pOptions){pOptions.handler$.off(INTERNAL_CLOSE_EVENT).on(INTERNAL_CLOSE_EVENT,function(pEvent,pAction){$.isFunction(pAction)?pAction.call(this,pOptions.dialog):"string"===$.type(pAction)?(navigation.redirect(pAction),pOptions.closeFunction.call()):pAction===!1?pOptions.closeFunction.call():(pOptions.closeFunction.call(),pOptions.triggeringElement$.trigger("apexafterclosedialog",[pAction]))})},navigation.dialog.fireCloseHandler=function(pHandler$,pAction){pHandler$.trigger(INTERNAL_CLOSE_EVENT,pAction)};var gDefaultBodyWidth,gFreezeDepth=0,allowNormalWidth=function(){$(document.body).css("width",gDefaultBodyWidth),$(window).off("apexwindowresized",allowNormalWidth)};navigation.beginFreezeScroll=function(){0===gFreezeDepth&&($(window).on("apexwindowresized",allowNormalWidth),gDefaultBodyWidth=document.body.style.width,$(document.body).width($(document.body).width()).addClass("apex-no-scroll")),gFreezeDepth+=1},navigation.endFreezeScroll=function(){gFreezeDepth-=1,0>=gFreezeDepth&&(allowNormalWidth(),$(document.body).removeClass("apex-no-scroll"),gFreezeDepth=0)}}(apex.navigation,apex.util,apex.jQuery);